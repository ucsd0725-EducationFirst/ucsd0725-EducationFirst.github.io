<!DOCTYPE html>
<html>
<head>
	<title>Education First</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
	<main>
		<header class="red darken-1 white-text">
			<div class="container">
				<h1 class="center-on-small-only">Education First</h1>
			</div>
		</header>

		<div class="container">
			<!-- Chat Box and Cards -->
			<div class="row">
				<div class="chatbox-box col s12 m6 l4">
					<div id="chatBox"></div>
					<hr>
					<form id="inputForm">
						<input type="text" id="userInput">
						<button type="submit" id="submit" class="btn blue white-text right">
							<i class="tiny material-icons">send</i>
						</button>
					</form>
				</div>

				<div class="col s12 m6 l8">
					<div id="university-box"></div>
				</div>
			</div>

			<!--EMPLOYMENT PROJECTION 2024................ -->
			<div class= "row">
				<div class="card-panel small teal">
					<img width='200 px' height="154px" src="assets/images/bls2014.png">
						<span class="title white-text">
						(var = Category) Employment Projection 2024
						</span>
				</div>
			</div>
			<!--End Employment projection..................-->
		</div>
	</main>

	<footer class="page-footer">
		<div class="container grey-text text-lighten-3">
			<h5>More Information to Explore</h5>
			<p>Bureau of Labor Statistics</p>
			<br>
		</div>
		<div class="footer-copyright">
			<div class="container">
				&copy; 2017
				<a href="#" class="grey-text text-lighten-4 right">Colophon</a>
			</div>
		</div>
	</footer>

	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.3.1/firebase.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

	<script src="assets/js/jquery.flot.min.js" charset="utf-8"></script>
	<script src="assets/js/jquery.flot.categories.min.js" charset="utf-8"></script>

	<script src="assets/js/us_states.js" charset="utf-8"></script>
	<script src="assets/js/chatbot.js" charset="utf-8"></script>
	<script src="assets/js/chat_controller.js" charset="utf-8"></script>
	<script src="assets/js/view_controller.js" charset="utf-8"></script>
	<script src="assets/js/scorecard_api.js" charset="utf-8"></script>

<script type="text/javascript">
$(document).ready(function(){
	$('.modal').modal();

	$(document).on("click", ".uni-card", function() {
		if ($(this).data("state") === "closed") {
			$(this).data({state: "open"});
			$(this).addClass("card-open");
			$(this).find(".school-info").show();
			$(this).find(".minimize-card").show();
		}
	});

	$(document).on("click", ".minimize-card", function() {
		var schoolID = $(this).data("schoolID");
		var card = $("#school-" + schoolID);
		card.removeClass("card-open");
		card.find(".school-info").hide();
		$(this).hide();
		// Delay closing card because .uni-card.click() fires after this,
		// which immediately opens the card again.
		setTimeout(function() {
			card.data({state: "closed"});
		}, 100);
	});

	var sc = new Scorecard();
	var bot = new ChatBot();
	var cc = new ChatController(bot, sc);

	var chatbox = $("#chatBox");

	function DisplayChatbotPrompt() {
		var prompt = cc.GetNextPrompt();
		prompt.forEach(function(p) {
			var bubble = $("<div class='bubble bot green lighten-3'>");
			bubble.html(p);
			chatbox.append(bubble);
		});
		chatbox[0].scrollTop = chatbox[0].scrollHeight;
	}

	$("#submit").click(function(e) {
		e.preventDefault();

		// Get and Reset Input
		var input = $("#userInput").val().trim();
		$("#inputForm")[0].reset();
		if (input.length < 1) { return; }

		// Log Input to Chat Window
		var bubble = $("<div class='bubble user indigo lighten-4'>");
		bubble.html(input);
		chatbox.append(bubble);
		chatbox[0].scrollTop = chatbox[0].scrollHeight;

		// Query wit.ai
		cc.HandleInput(input, function() {
			DisplayChatbotPrompt();
			console.log(cc)
		});
	});

	DisplayChatbotPrompt();
});
</script>
</body>
</html>
